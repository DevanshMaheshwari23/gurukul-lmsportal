# Apache configuration for Gurukul LMS in subdirectory
# Place this in your Apache configuration directory (e.g., /etc/apache2/sites-available/)

<IfModule mod_proxy.c>
    # Ensure proxy modules are enabled
    <IfModule mod_proxy_http.c>
        # Proxy rules for the Next.js application
        ProxyRequests Off
        ProxyPreserveHost On

        # Proxy all requests under /gurukul to the Next.js server
        <Location /gurukul>
            ProxyPass http://localhost:3000/gurukul
            ProxyPassReverse http://localhost:3000/gurukul
        </Location>

        # Proxy API requests
        <Location /gurukul/api>
            ProxyPass http://localhost:3000/gurukul/api
            ProxyPassReverse http://localhost:3000/gurukul/api
        </Location>

        # Add proper headers
        <LocationMatch "/gurukul">
            Header set Cache-Control "public, max-age=0, must-revalidate"
        </LocationMatch>

        # Handle static files with long cache times
        <LocationMatch "/gurukul/_next/static/">
            Header set Cache-Control "public, max-age=31536000, immutable"
        </LocationMatch>
    </IfModule>
</IfModule>

# Enable these Apache modules if not already enabled:
# a2enmod proxy
# a2enmod proxy_http
# a2enmod headers 